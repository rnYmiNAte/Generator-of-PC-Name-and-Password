name: Generate PC Info & Credentials

on:
  workflow_dispatch:

jobs:
  generate:
    runs-on: windows-latest

    steps:
      - name: Generate PC Name, Username & Password
        shell: pwsh
        run: |
          # Generate PC Name
          $RandomID = Get-Random -Minimum 1000 -Maximum 9999
          $PCName = "WIN-PC-$RandomID"

          # Generate Username
          $Username = "user_$RandomID"

          # Generate Secure Password
          Add-Type -AssemblyName System.Web
          $Password = [System.Web.Security.Membership]::GeneratePassword(12,3)

          # Output to GitHub Actions
          echo "PC_NAME=$PCName" | Out-File -FilePath $env:GITHUB_ENV -Append
          echo "USERNAME=$Username" | Out-File -FilePath $env:GITHUB_ENV -Append
          echo "PASSWORD=$Password" | Out-File -FilePath $env:GITHUB_ENV -Append

      - name: Show Generated Values
        run: |
          echo "PC Name     : $env:PC_NAME"
          echo "Username    : $env:USERNAME"
          echo "Password    : $env:PASSWORD"
